/*!
 * PSPDFKit for Web 0.0.0-dev (https://pspdfkit.com/web)
 *
 * Copyright (c) 2016-2022 PSPDFKit GmbH. All rights reserved.
 *
 * THIS SOURCE CODE AND ANY ACCOMPANYING DOCUMENTATION ARE PROTECTED BY INTERNATIONAL COPYRIGHT LAW
 * AND MAY NOT BE RESOLD OR REDISTRIBUTED. USAGE IS BOUND TO THE PSPDFKIT LICENSE AGREEMENT.
 * UNAUTHORIZED REPRODUCTION OR DISTRIBUTION IS SUBJECT TO CIVIL AND CRIMINAL PENALTIES.
 * This notice may not be removed from this file.
 *
 * PSPDFKit uses several open source third-party components: https://pspdfkit.com/acknowledgements/web/
 */
"use strict";(self.webpackChunkPSPDFKit=self.webpackChunkPSPDFKit||[]).push([[3610],{66142:function(e,t,n){n.r(t),n.d(t,{corePool:function(){return g.m},validateStandaloneConfiguration:function(){return g.MO},normalizeCoreOptions:function(){return g.oc},default:function(){return _},customFontsPromiseRef:function(){return C},loadModule:function(){return I}});var r,a=n(90484),s=n(92137),i=n(96156),o=n(6610),c=n(5991),u=n(66213),l=n(10379),f=n(46070),p=n(77608),h=n(87757),d=n.n(h),m=n(14968),b=n(35369),y=n(70545),g=n(27297),v=n(95453),w=n(80614),k=n(96233),P=n(5164),O=n(49029),A=n(33502);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){(0,i.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,p.Z)(e);if(t){var a=(0,p.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,f.Z)(this,n)}}var S=.3,_=function(e){(0,l.Z)(a,e);var t,n=D(a);function a(e){var t;(0,o.Z)(this,a);var s=e.baseUrl||(0,m.SV)(window.document),i=x(x({},e),{},{baseUrl:s});if("string"!=typeof i.baseUrl)throw new y.p2("`baseUrl` is mandatory and must be a valid URL, e.g. `https://example.com/`");if("string"!=typeof i.document&&!(i.document instanceof ArrayBuffer))throw new y.p2("document must be either an URL to a supported document type (PDF and images), e.g. `https://example.com/document.pdf`, or an `ArrayBuffer`");if(r&&r!==i.licenseKey)throw new y.p2("Trying to re-use PSPDFKit for Web with a different licenseKey than the previous one.\nUnfortunately we only allow one licenseKey per instance.\nPlease contact support for further assistance.");if("string"==typeof i.licenseKey&&i.licenseKey.startsWith("TRIAL-"))throw new y.p2("You're using the npm key instead of the license key. This key is used to download the PSPDFKit for Web package via the node package manager.\n\nLeave out the license key to activate as a trial.");return(t=n.call(this,i)).destroyed=!1,t}return(0,c.Z)(a,[{key:"load",value:(t=(0,s.Z)(d().mark((function e(){var t,n,a,s,i,o,c,u,l,f,p,h,m,g,v,F=arguments;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=F.length>0&&void 0!==F[0]?F[0]:{},a=.2,t.progressCallback&&t.progressCallback("loading",a),n="string"==typeof this._state.document?fetch(this._state.document,{credentials:"same-origin"}).then((function(e){return e.arrayBuffer()})).finally((function(){a+=S,t.progressCallback&&t.progressCallback("loading",a)})):this._state.document,e.next=6,I(this.client,this._state).finally((function(){a+=S,t.progressCallback&&t.progressCallback("loading",a)}));case 6:return s=e.sent,(0,y.kG)(s),i=s.features,o=s.signatureFeatureAvailability,c=o===O.H.ELECTRONIC_SIGNATURES&&i.includes(A.sw.WEB_ANNOTATION_EDITING)&&this._state.forceLegacySignaturesFeature?O.H.LEGACY_SIGNATURES:o,this._state=this._state.set("features",(0,b.aV)(i)).set("signatureFeatureAvailability",c),r=this._state.licenseKey,e.next=14,n;case 14:if(u=e.sent,e.prev=15,!this.destroyed){e.next=22;break}return e.next=19,new Promise((function(){}));case 19:l=e.sent,e.next=25;break;case 22:return e.next=24,this.client.openDocument(u,t.password);case 24:l=e.sent;case 25:e.next=32;break;case 27:throw e.prev=27,e.t0=e.catch(15),"INVALID_PASSWORD"===e.t0.message&&this._state.document instanceof ArrayBuffer&&(this._state=this._state.set("document",e.t0.callArgs[0])),"IMAGE_DOCUMENTS_NOT_LICENSED"===e.t0.message&&(e.t0.message="The image documents feature is not enabled for your license key. Please contact support or sales to purchase the UI module for PSPDFKit for Web."),e.t0;case 32:if(!this._XFDF){e.next=35;break}return e.next=35,this.client.importXFDF(this._XFDF.source,this._XFDF.keepCurrentAnnotations);case 35:if(f=[],!w.Ei.PDF_JAVASCRIPT){e.next=44;break}return e.next=39,this.client.enablePDFJavaScriptSupport();case 39:return p=e.sent,e.next=42,this.client.runPDFFormattingScripts();case 42:h=e.sent,f=(0,P.gE)(p,h);case 44:if(!(this._instantJSON&&this._instantJSON.pdfId&&l.ID.permanent)){e.next=51;break}if(m=this._instantJSON.pdfId,g=l.ID,m.permanent===g.permanent){e.next=49;break}throw new y.p2("Could not instantiate from Instant JSON: Permanent PDF ID mismatch.\nPlease use the same PDF document that was used to create this Instant JSON.\nFor more information, please visit: https://pspdfkit.com/guides/web/current/importing-exporting/instant-json/");case 49:if(m.changing===g.changing){e.next=51;break}throw new y.p2("Could not instantiate from Instant JSON: Changing PDF ID mismatch.\nPlease use the same revision of this PDF document that was used to create this Instant JSON.\nFor more information, please visit: https://pspdfkit.com/guides/web/current/importing-exporting/instant-json/");case 51:if(!this._trustedCAsCallback){e.next=67;break}return e.prev=52,e.next=55,this._trustedCAsCallback();case 55:if(v=e.sent,Array.isArray(v)){e.next=58;break}throw new y.p2("Certificates response must be an array");case 58:if(!v.some((function(e){return!(e instanceof ArrayBuffer)&&"string"!=typeof e}))){e.next=60;break}throw new y.p2("All certificates must be passed as ArrayBuffer (DER) or string (PEM)");case 60:return e.next=62,this.client.loadCertificates(v.map(k.uF));case 62:e.next=67;break;case 64:throw e.prev=64,e.t1=e.catch(52),new y.p2("Could not retrieve certificates for digital signatures validation: ".concat(e.t1.message,"."));case 67:return this._state=this._state.set("documentResponse",l),e.abrupt("return",{features:this._state.features,signatureFeatureAvailability:this._state.signatureFeatureAvailability,hasPassword:!!t.password,allowedTileScales:"all",jsActionChanges:f});case 69:case"end":return e.stop()}}),e,this,[[15,27],[52,64]])}))),function(){return t.apply(this,arguments)})},{key:"destroy",value:function(){this.destroyed=!0,(0,u.Z)((0,p.Z)(a.prototype),"destroy",this).call(this)}}]),a}(g.ZP);var C={current:void 0};function I(e,t){var n;C.current=C.current||(t.customFonts?(n=t.customFonts,Promise.all(n.map((function(e){return new Promise((function(t){var n;(0,y.kG)(e.name),null==e||null===(n=e.callback)||void 0===n||n.call(e,e.name).then((function(n){(0,y.kG)(e.name),n instanceof Blob?t({name:e.name,data:n}):((0,y.vU)("Callback for retrieving font ".concat(e.name," didn't returned a Blob. It returned ").concat((0,a.Z)(n))),t())})).catch((function(n){(0,y.vU)("Error returned by callback for retrieving font ".concat(e.name,". ").concat(n)),t()}))}))}))).then((function(e){return e.filter(Boolean)}))):void 0);var r=t.electronAppName||(0,v.$u)()||window.location.origin;return e.loadNativeModule(t.baseUrl,{mainThreadOrigin:r,disableWebAssembly:t.disableWebAssembly,disableWebAssemblyStreaming:t.disableWebAssemblyStreaming,enableAutomaticLinkExtraction:t.enableAutomaticLinkExtraction,overrideMemoryLimit:t.overrideMemoryLimit}).then((0,s.Z)(d().mark((function n(){return d().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!C.current){n.next=12;break}return n.t1=e,n.t2=t.baseUrl,n.t3=t.licenseKey,n.t4=r,n.next=7,C.current;case 7:n.t5=n.sent,n.t6={mainThreadOrigin:n.t4,customFonts:n.t5},n.t0=n.t1.load.call(n.t1,n.t2,n.t3,n.t6),n.next=13;break;case 12:n.t0=e.load(t.baseUrl,t.licenseKey,{mainThreadOrigin:r});case 13:return n.abrupt("return",n.t0);case 14:case"end":return n.stop()}}),n)}))))}}}]);